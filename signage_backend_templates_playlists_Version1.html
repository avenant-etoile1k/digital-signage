<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Playlists – Signage</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tailwind.css') }}">
</head>
<body class="bg-gray-900 text-gray-100">
  <nav class="bg-gray-800 p-4">
    <a href="{{ url_for('api.dashboard') }}" class="underline">Tableau de bord</a>
    <a href="{{ url_for('api.logout') }}" class="float-right">Déconnexion</a>
  </nav>
  <main class="p-4">
    <h1 class="text-xl mb-4">Playlists</h1>
    <form action="{{ url_for('api.create_playlist') }}" method="post" class="mb-6 flex gap-2">
      <input type="text" name="name" placeholder="Nom de la playlist" required class="p-2 rounded text-gray-900" />
      <button class="bg-blue-600 px-3 py-2 rounded" type="submit">Créer</button>
    </form>
    <div class="grid grid-cols-1 gap-4">
      {% for playlist in playlists %}
      <div class="bg-gray-800 rounded p-4">
        <div class="flex items-center">
          <form action="{{ url_for('api.rename_playlist', playlist_id=playlist.id) }}" method="post" class="mr-2">
            <input type="text" name="name" value="{{ playlist.name }}" class="bg-gray-700 rounded p-1 text-gray-100" />
            <button type="submit" class="ml-1 text-blue-300">Renommer</button>
          </form>
          {% if playlist.is_active %}
            <span class="bg-green-600 text-xs px-2 py-1 rounded ml-2">Active</span>
          {% endif %}
          <form action="{{ url_for('api.delete_playlist', playlist_id=playlist.id) }}" method="post" class="ml-auto">
            <button class="text-red-400" type="submit" onclick="return confirm('Supprimer cette playlist ?')">Suppr</button>
          </form>
        </div>
        <div class="mt-2">
          <b>Items :</b>
          <ul class="ml-5 list-disc">
            {% for item in playlist.items %}
            <li>
              <span class="font-mono text-sm">{{ item.asset.original_name }}</span>
              <span class="text-gray-400 text-xs">({{ item.asset.type }})</span>
              <form action="{{ url_for('api.remove_playlist_item', item_id=item.id) }}" method="post" class="inline">
                <button class="text-red-400 text-xs" type="submit">Retirer</button>
              </form>
            </li>
            {% endfor %}
          </ul>
          <form action="{{ url_for('api.add_playlist_item', playlist_id=playlist.id) }}" method="post" class="mt-2">
            <select name="asset_id" class="p-1 rounded text-gray-900">
              {% for asset in assets %}
                <option value="{{ asset.id }}">{{ asset.original_name }} ({{ asset.type }})</option>
              {% endfor %}
            </select>
            <button class="bg-blue-700 px-2 py-1 rounded" type="submit">Ajouter media</button>
          </form>
        </div>
      </div>
      {% endfor %}
    </div>
  </main>
</body>
</html>